<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIRA - O melhor do cinema brasileiro</title>
    <link rel="stylesheet" href="./landing.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <!-- Modal de Login -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="modal-logo">
                <img src="./images/MIRA.png" alt="MIRA">
            </div>
            <h2>Entrar na MIRA</h2>
            <div id="loginMessage" class="message"></div>
            <form class="auth-form" id="loginForm">
                <div class="form-group">
                    <input type="email" id="loginEmail" placeholder="E-mail" required>
                </div>
                <div class="form-group">
                    <input type="password" id="loginPassword" placeholder="Senha" required>
                </div>
                <button type="submit" class="btn-primary full-width">Entrar</button>
            </form>
            <div class="auth-links">
                <a href="#" id="forgotPassword">Esqueci minha senha</a>
                <p>Não tem uma conta? <a href="#" id="showRegister">Cadastre-se</a></p>
            </div>
        </div>
    </div>

    <!-- Modal de Registro -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="modal-logo">
                <img src="./images/MIRA.png" alt="MIRA">
            </div>
            <h2>Criar Conta</h2>
            <div id="registerMessage" class="message"></div>
            <form class="auth-form" id="registerForm">
                <div class="form-group">
                    <input type="text" id="regName" placeholder="Nome completo" required>
                </div>
                <div class="form-group">
                    <input type="email" id="regEmail" placeholder="E-mail" required>
                </div>
                <div class="form-group">
                    <input type="password" id="regPassword" placeholder="Senha" required>
                </div>
                <div class="form-group">
                    <input type="password" id="regConfirmPassword" placeholder="Confirmar senha" required>
                </div>
                <div class="form-group">
                    <select id="regRole" required>
                        <option value="">Selecione um tipo de conta</option>
                        <option value="ROLE_USER">Espectador</option>
                        <option value="ROLE_PRODUCER">Produtor</option>
                    </select>
                </div>
                <div class="form-group" id="cnpjGroup" style="display: none;">
                    <input type="text" id="regCnpj" placeholder="CNPJ (apenas números)">
                </div>
                <button type="submit" class="btn-primary full-width">Criar Conta</button>
            </form>
            <div class="auth-links">
                <p>Já tem uma conta? <a href="#" id="showLogin">Faça login</a></p>
            </div>
        </div>
    </div>

   <section class="hero-section">
        <header class="main-header" id="main-header">
            <div class="logo">
                <img src="./images/MIRA.png" alt="MIRA">
            </div>
            <nav class="nav-links">
                <a href="#experience">Experiência</a>
                <a href="#audience">Público</a>
                <a href="#accessibility">Acessibilidade</a>
                <a href="#catalog">Catálogo</a>
                <a href="#plans">Planos</a>
                <a href="#" id="loginBtn">Entrar</a>
            </nav>
        </header>

        <div class="hero-content-container">
            <div class="hero-text">
                <h1 class="hero-title">O MELHOR DO CINEMA <span>BRASILEIRO</span></h1>
                <p class="hero-subtitle">Assista a produções nacionais únicas, conheça o melhor do audiovisual nacional e desfrute a beleza que é esse cinema!</p>
                <div class="hero-buttons">
                    <button class="btn-primary" id="heroLoginBtn">Experimente Grátis</button>
                    <button class="btn-secondary">Conheça os Planos</button>
                </div>
            </div>
        </div>
    </section>

    <section class="section-experience" id="experience">
        <h2 class="section-title">EXPERIÊNCIA MIRA DE CINEMA</h2>
        <div class="experience-card-container">
            <div class="experience-card">
                <i class="fas fa-film"></i>
                <h3>Conteúdo Exclusivo</h3>
                <p>Filmes, documentários e séries que você não encontra em outras plataformas</p>
            </div>
            <div class="experience-card">
                <i class="fas fa-universal-access"></i>
                <h3>Acessibilidade Garantida</h3>
                <p>Recursos de acessibilidade para que todos possam desfrutar do cinema brasileiro</p>
            </div>
            <div class="experience-card">
                <i class="fas fa-users"></i>
                <h3>Comunidade Ativa</h3>
                <p>Conecte-se com outros amantes do cinema brasileiro</p>
            </div>
        </div>
    </section>

    <section class="section-audience" id="audience">
        <div class="audience-container">
            <div class="audience-card" id="card-spectator">
                <div>
                    <h3 class="audience-title">PARA ESPECTADORES</h3>
                    <p class="audience-text">
                        Descubra o melhor do cinema nacional com curadoria de especialistas. Assista a filmes e documentários únicos, indisponíveis em outras plataformas.
                    </p>
                </div>
                <button class="btn-clean">Ver Catálogo</button>
            </div>

            <div class="audience-card" id="card-producer">
                <div>
                    <h3 class="audience-title">PARA PRODUTORES</h3>
                    <p class="audience-text">
                        Publique o seu trabalho e receba royalties justos. Conecte-se a um público apaixonado e aumente a visibilidade das suas produções.
                    </p>
                </div>
                <button class="btn-clean">Saiba Mais</button>
            </div>
        </div>
    </section>

    <section class="section-accessibility" id="accessibility">
        <div class="accessibility-content-container">
            <h2 class="section-title">ACESSÍVEL PARA TODOS</h2>
            <p class="accessibility-subtitle">
                A acessibilidade é a nossa prioridade. Oferecemos recursos exclusivos para que o cinema nacional possa ser desfrutado por todas as pessoas.
            </p>
            <div class="accessibility-cards">
                <div class="access-card">
                    <i class="fas fa-closed-captioning"></i>
                    <h3 class="card-title">Legendas Aprimoradas</h3>
                    <p>Legendas adaptadas para deficientes auditivos, incluindo descrição de sons e emoções.</p>
                </div>
                <div class="access-card">
                    <i class="fas fa-assistive-listening-systems"></i>
                    <h3 class="card-title">Audiodescrição</h3>
                    <p>Narrações detalhadas para deficientes visuais, garantindo a compreensão completa da cena.</p>
                </div>
                <div class="access-card">
                    <i class="fas fa-sign-language"></i>
                    <h3 class="card-title">LIBRAS</h3>
                    <p>Seleção de filmes com tradução em Língua Brasileira de Sinais embutida.</p>
                </div>
            </div>
        </div>
    </section>

    <section class="section-catalog" id="catalog">
        <h2 class="section-title">UM CATÁLOGO ÚNICO</h2>
        <div class="catalog-cards">
            <div class="catalog-card" style="background-image: url('https://images.unsplash.com/photo-1489599809505-f2d4c3f54b3f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80')">
                <span>DOCUMENTÁRIOS</span>
            </div>
            <div class="catalog-card" style="background-image: url('https://images.unsplash.com/photo-1536440136628-849c177e76a1?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80')">
                <span>FILMES</span>
            </div>
            <div class="catalog-card" style="background-image: url('https://images.unsplash.com/photo-1626814026160-2237a95fc5a0?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80')">
                <span>SÉRIES</span>
            </div>
            <div class="catalog-card" style="background-image: url('https://images.unsplash.com/photo-1574267432553-4b4628081c31?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80')">
                <span>CURTAS</span>
            </div>
        </div>

        <h3 class="subsection-title">O QUE VOCÊ ENCONTRA:</h3>
        <div class="resource-cards">
            <div class="resource-card" style="background-image: url('https://images.unsplash.com/photo-1485846234645-a62644f84728?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80')">
                <span>Produções Independentes</span>
            </div>
            <div class="resource-card" style="background-image: url('https://images.unsplash.com/photo-1517604931442-7e0c8ed2963c?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80')">
                <span>Clássicos do Cinema Nacional</span>
            </div>
            <div class="resource-card" style="background-image: url('https://images.unsplash.com/photo-1595769810453-fbd92c5d3d00?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80')">
                <span>Conteúdo Regional</span>
            </div>
            <div class="resource-card" style="background-image: url('https://images.unsplash.com/photo-1518676590629-3dcbd9c5a5c9?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80')">
                <span>Festivais Exclusivos</span>
            </div>
        </div>
    </section>

    <section class="section-sabia" id="sabia">
        <div class="sabia-container">
            <h2 class="sabia-title">SABIÁ: SEU GUIA DE CINEMA</h2>
            <p class="sabia-text">
                Conheça o Sabiá, a nossa inteligência artificial que te ajuda a mergulhar nas histórias. Ele fornece informações contextuais, entrevistas com diretores e curiosidades sobre o elenco em tempo real.
            </p>
            <div class="sabia-cta">
                <button class="btn-primary">Conheça o Sabiá</button>
            </div>
        </div>
    </section>

    <section class="section-plans" id="plans">
        <div class="container">
            <h2 class="section-title">NOSSOS PLANOS</h2>
            <div class="plan-cards">
                <div class="plan-card">
                    <div class="card-header">
                        <div class="plan-icon"><i class="fas fa-film"></i></div>
                        <h3>FREEMIUM</h3>
                    </div>
                    <p class="plan-description">Acesso básico ao catálogo MIRA</p>
                    <ul class="plan-features">
                        <li>Catálogo limitado</li>                       
                        <li>Acesso a conteúdo selecionado</li>
                    </ul>
                    <p class="price">Grátis</p>
                    <p class="price-period">para sempre</p>
                    <button class="btn-clean" style="align-self: center;">Experimentar</button>
                </div>
                <div class="plan-card featured">
                    <div class="card-header">
                        <div class="plan-icon"><i class="fas fa-crown"></i></div>
                        <h3>PREMIUM</h3>
                    </div>
                    <p class="plan-description">Experiência completa MIRA</p>
                    <ul class="plan-features">
                        <li>Acesso ilimitado a todo o catálogo</li>
                        <li>Eventos exclusivos (cinema ao ar livre)</li>
                        <li>Uso completo do Sabiá (IA)</li>
                    </ul>
                    <p class="price">R$ 29,90</p>
                    <p class="price-period">por mês</p>
                    <button class="btn-clean" style="align-self: center;">Assinar Agora</button>
                </div>
            </div>
        </div>
    </section>

    <section class="section-review" id="review">
        <h3 class="review-text">SEJA O PROTAGONISTA DA SUA PRÓPRIA HISTÓRIA!</h3>
        <div class="rating"></div>
        <button class="btn-primary" style="font-size: 1.2em;">Começar Agora</button>
    </section>

    <footer class="main-footer">
        <div class="footer-content">
            <div class="footer-logo">
                <img src="./images/MIRA.png" alt="MIRA">
            </div>
            <div class="footer-links">
                <a href="#experience">Experiência</a>
                <a href="#audience">Público</a>
                <a href="#accessibility">Acessibilidade</a>
                <a href="#catalog">Catálogo</a>
                <a href="#sabia">Sabiá</a>
                <a href="#plans">Planos</a>
            </div>
            <div class="social-icons">
                <a href="#"><i class="fab fa-facebook"></i></a>
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
                <a href="#"><i class="fab fa-youtube"></i></a>
            </div>
            <p>© 2025 MIRA. Todos os direitos reservados.</p>
        </div>
    </footer>

    <script>
       // Header scroll effect
    const loginModal = document.getElementById('loginModal');
    const registerModal = document.getElementById('registerModal');
    const loginBtn = document.getElementById('loginBtn');
    const heroLoginBtn = document.getElementById('heroLoginBtn');
    const showRegister = document.getElementById('showRegister');
    const showLogin = document.getElementById('showLogin');
    const closeButtons = document.querySelectorAll('.close');
    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');
    const regRole = document.getElementById('regRole');
    const cnpjGroup = document.getElementById('cnpjGroup');
    const loginMessage = document.getElementById('loginMessage');
    const registerMessage = document.getElementById('registerMessage');

    // Estado da aplicação
    let isLoading = false;

    // ======================================= //
    // FUNÇÕES DE SIMULAÇÃO/INTEGRAÇÃO API 
    // ======================================= //

    /**
     * @description Simula a chamada de API de Login. SUBSTITUA PELA SUA LÓGICA REAL.
     * @param {string} email 
     * @param {string} password 
     * @returns {Promise<string>} O token de autenticação.
     */
    async function loginUser(email, password) {
        // Exemplo de endpoint real: const API_URL = 'http://localhost:8080/api/auth/login';
        
        // --- SIMULAÇÃO DE LOGIN ---
        await new Promise(resolve => setTimeout(resolve, 1000)); // Simula delay da rede

        if (email === "teste@mira.com" && password === "senha123") {
            const mockToken = "eyJhbGciOiJIUzUxMiJ9.mocked.token.user";
            localStorage.setItem('authToken', mockToken);
            return mockToken;
        } else if (email === "produtor@mira.com" && password === "senha123") {
            const mockToken = "eyJhbGciOiJIUzUxMiJ9.mocked.token.producer";
            localStorage.setItem('authToken', mockToken);
            return mockToken;
        } else {
            throw new Error('Credenciais inválidas. Tente "teste@mira.com" / "senha123"');
        }
        // --- FIM DA SIMULAÇÃO ---
    }


    /**
     * @description Simula a chamada de API de Registro. SUBSTITUA PELA SUA LÓGICA REAL.
     * @param {string} email 
     * @param {string} password 
     * @param {string} name 
     * @param {string} role 
     * @param {string | null} cnpj 
     * @returns {Promise<string>} O token de autenticação.
     */
    async function registerUser(email, password, name, role, cnpj) {
        // Exemplo de endpoint real: const API_URL = 'http://localhost:8080/api/auth/register';

        // --- SIMULAÇÃO DE REGISTRO ---
        await new Promise(resolve => setTimeout(resolve, 1000)); // Simula delay da rede

        // Simulação de verificação de e-mail duplicado
        if (email === "duplicado@mira.com") {
            throw new Error('Este e-mail já está cadastrado.');
        }

        const mockToken = `eyJhbGciOiJIUzUxMiJ9.mocked.token.${role}`;
        localStorage.setItem('authToken', mockToken);
        
        // Simulação de sucesso
        return mockToken;
        // --- FIM DA SIMULAÇÃO ---
    }


    // ======================================= //
    // FUNÇÕES DE UTILIDADE E UI
    // ======================================= //

    function showMessage(element, message, type = 'error') {
        element.textContent = message;
        element.className = `message ${type}`;
        element.style.display = 'block';
        
        // Auto-esconder mensagens de sucesso após 3 segundos
        if (type === 'success') {
            setTimeout(() => {
                element.style.display = 'none';
                closeModals(); // Fecha o modal após o login/registro
                location.reload(); // Recarrega a página para atualizar o estado do login
            }, 1500);
        }
    }

    function clearMessages() {
        loginMessage.style.display = 'none';
        registerMessage.style.display = 'none';
    }

    function setLoading(state, formId) {
        isLoading = state;
        const form = document.getElementById(formId);
        if (!form) return;
        const button = form.querySelector('button[type="submit"]');

        if (state) {
            button.classList.add('loading');
            button.disabled = true;
            button.textContent = 'Carregando...'; 
        } else {
            button.classList.remove('loading');
            button.disabled = false;
            button.textContent = formId === 'loginForm' ? 'Entrar' : 'Criar Conta';
        }
    }

    function validateEmail(email) {
        const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return re.test(email);
    }

    function validatePassword(password) {
        return password.length >= 6;
    }

    function validateCNPJ(cnpj) {
        // Remove caracteres não numéricos
        cnpj = cnpj.replace(/[^\d]/g, '');
        
        // CNPJ deve ter 14 dígitos
        if (cnpj.length !== 14) return false;
        
        // (A lógica completa de validação de CNPJ é complexa, 
        // mas a implementação do HTML para remover não-dígitos e
        // verificar o tamanho já ajuda muito)
        // Por hora, apenas checamos o tamanho de 14 dígitos.
        
        return true; 
    }


    function openLoginModal() {
        clearMessages();
        loginForm.reset();
        loginModal.style.display = 'block';
        registerModal.style.display = 'none';
    }

    function openRegisterModal() {
        clearMessages();
        registerForm.reset();
        regRole.dispatchEvent(new Event('change')); // Reseta a exibição do CNPJ
        registerModal.style.display = 'block';
        loginModal.style.display = 'none';
    }

    function closeModals() {
        loginModal.style.display = 'none';
        registerModal.style.display = 'none';
    }


    // ======================================= //
    // EVENT LISTENERS (FLUXO E SUBMISSÕES)
    // ======================================= //

    // Navegação entre modais
    loginBtn.addEventListener('click', function(e) {
        e.preventDefault();
        openLoginModal();
    });

    heroLoginBtn.addEventListener('click', function() {
        openLoginModal();
    });

    showRegister.addEventListener('click', function(e) {
        e.preventDefault();
        openRegisterModal();
    });

    showLogin.addEventListener('click', function(e) {
        e.preventDefault();
        openLoginModal();
    });

    // Fechar modais
    closeButtons.forEach(button => {
        button.addEventListener('click', function() {
            closeModals();
        });
    });

    window.addEventListener('click', function(event) {
        if (event.target.classList.contains('modal')) {
            closeModals();
        }
    });

    // Mostrar/ocultar campo CNPJ baseado no role
    regRole.addEventListener('change', function() {
        if (this.value === 'ROLE_PRODUCER') {
            cnpjGroup.style.display = 'block';
            document.getElementById('regCnpj').setAttribute('required', 'required');
        } else {
            cnpjGroup.style.display = 'none';
            document.getElementById('regCnpj').removeAttribute('required');
        }
    });

    // Mascarar CNPJ
    document.getElementById('regCnpj').addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        
        // Apenas aplica a máscara se o tamanho for 14
        if (value.length <= 14) {
            value = value.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/, '$1.$2.$3/$4-$5');
            e.target.value = value;
        } else {
            e.target.value = value.substring(0, 14).replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/, '$1.$2.$3/$4-$5');
        }
    });

    // --- SUBMISSÃO DE LOGIN ---
    loginForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        if (isLoading) return;
        
        const email = document.getElementById('loginEmail').value;
        const password = document.getElementById('loginPassword').value;
        
        if (!validateEmail(email)) {
            showMessage(loginMessage, 'Por favor, insira um e-mail válido.', 'error');
            return;
        }
        
        if (!validatePassword(password)) {
            showMessage(loginMessage, 'A senha deve ter pelo menos 6 caracteres.', 'error');
            return;
        }
        
        setLoading(true, 'loginForm');
        
        try {
            const token = await loginUser(email, password);
            if (token) {
                showMessage(loginMessage, 'Login realizado com sucesso! Redirecionando...', 'success');
            }
        } catch (error) {
            // Se o erro for um objeto com message, ou uma string
            const errorMessage = error.message || 'Erro ao fazer login. Tente novamente.';
            showMessage(loginMessage, errorMessage, 'error');
        } finally {
            setLoading(false, 'loginForm');
        }
    });

    // --- SUBMISSÃO DE REGISTRO ---
    registerForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        if (isLoading) return;
        
        const name = document.getElementById('regName').value;
        const email = document.getElementById('regEmail').value;
        const password = document.getElementById('regPassword').value;
        const confirmPassword = document.getElementById('regConfirmPassword').value;
        const role = document.getElementById('regRole').value;
        const cnpj = document.getElementById('regCnpj').value.replace(/\D/g, '');
        
        // Validações
        if (!name.trim()) {
            showMessage(registerMessage, 'Por favor, insira seu nome completo.', 'error');
            return;
        }
        
        if (!validateEmail(email)) {
            showMessage(registerMessage, 'Por favor, insira um e-mail válido.', 'error');
            return;
        }
        
        if (!validatePassword(password)) {
            showMessage(registerMessage, 'A senha deve ter pelo menos 6 caracteres.', 'error');
            return;
        }
        
        if (password !== confirmPassword) {
            showMessage(registerMessage, 'As senhas não coincidem.', 'error');
            return;
        }
        
        if (!role) {
            showMessage(registerMessage, 'Por favor, selecione um tipo de conta.', 'error');
            return;
        }
        
        if (role === 'ROLE_PRODUCER' && !validateCNPJ(cnpj)) {
            showMessage(registerMessage, 'Por favor, insira um CNPJ válido (14 dígitos).', 'error');
            return;
        }
        
        setLoading(true, 'registerForm');
        
        try {
            const token = await registerUser(email, password, name, role, role === 'ROLE_PRODUCER' ? cnpj : null);
            if (token) {
                showMessage(registerMessage, 'Conta criada com sucesso! Redirecionando...', 'success');
            }
        } catch (error) {
            const errorMessage = error.message || 'Erro ao criar conta. Tente novamente.';
            showMessage(registerMessage, errorMessage, 'error');
        } finally {
            setLoading(false, 'registerForm');
        }
    });


    // Header scroll effect
        window.addEventListener('scroll', function() {
            const header = document.getElementById('main-header');
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });

        // Scroll animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver(function(entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('section-visible');
                }
            });
        }, observerOptions);

        // Observe all sections
        document.querySelectorAll('section').forEach(section => {
            observer.observe(section);
        });

        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                if (targetId === '#') return;
                
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 80,
                        behavior: 'smooth'
                    });
                }
            });
        });

    // Verificar se usuário já está logado ao carregar a página
    document.addEventListener('DOMContentLoaded', function() {
        const token = localStorage.getItem('authToken');
        if (token) {
            // Usuário já está logado, atualiza o botão
            const loginBtn = document.getElementById('loginBtn');
            if (loginBtn) {
                loginBtn.textContent = 'Minha Conta';
                loginBtn.removeEventListener('click', openLoginModal); // Remove o evento antigo
                // Adicionar um novo evento para redirecionar ou abrir o painel do usuário
                loginBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Lógica para ir para a dashboard ou painel da conta
                    alert('Usuário logado! Redirecionando para Minha Conta...');
                    // window.location.href = '/minha-conta'; 
                });
            }
        }
        });
    </script>
</body>
</html>