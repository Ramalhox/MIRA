<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feedback de Acessibilidade - MiraCine</title>
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/main.css">
</head>

<body>
    <div id="sabia-widget-container">

    </div>

    <main class="feedback-container">
        <div class="feedback-progress">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text">
                <span>Passo 1 de 4</span>
                <span>Feedback de Acessibilidade</span>
            </div>
        </div>

        <!-- Header -->
        <div class="feedback-header">
            <h1><i class="fas fa-universal-access"></i> Feedback de Acessibilidade</h1>
            <p>Sua opinião nos ajuda a melhorar a experiência para todos os usuários</p>
        </div>

        <!-- Card do Filme Assistido -->
        <div class="movie-review-card">
            <div class="movie-review-poster">
                <img src="https://upload.wikimedia.org/wikipedia/pt/9/96/Bacurau_p%C3%B4ster.jpg"
                    alt="Pôster do Filme Observar e Absorver">
            </div>
            <div class="movie-review-info">
                <h3>Observar e Absorver</h3>
                <p><i class="far fa-calendar"></i> Assistido em: 15 Nov 2024</p>
                <p><i class="far fa-clock"></i> Duração: 1h 41min</p>
                <p><i class="fas fa-star"></i> Sua avaliação: 4.7/5</p>
            </div>
        </div>

        <!-- Formulário de Feedback -->
        <form id="accessibilityFeedbackForm" class="feedback-form">

            <div class="form-section">
                <h3><i class="fas fa-tools"></i> Quais ferramentas de acessibilidade você utilizou?</h3>
                <div class="tool-rating-grid">
                    <!-- Legenda -->
                    <div class="tool-item">
                        <div class="tool-header">
                            <div class="tool-icon">
                                <i class="fas fa-closed-captioning"></i>
                            </div>
                            <div class="tool-info">
                                <h4>Legenda (CC)</h4>
                                <p>Legenda para diálogos e sons importantes</p>
                            </div>
                        </div>
                        <div class="yes-no-buttons">
                            <button type="button" class="yes-no-btn" data-tool="legenda" data-value="sim">Sim</button>
                            <button type="button" class="yes-no-btn" data-tool="legenda" data-value="nao">Não</button>
                        </div>
                    </div>

                    <!-- Audiodescrição -->
                    <div class="tool-item">
                        <div class="tool-header">
                            <div class="tool-icon">
                                <i class="fas fa-assistive-listening-systems"></i>
                            </div>
                            <div class="tool-info">
                                <h4>Audiodescrição (AD)</h4>
                                <p>Narração descritiva de cenas e ações</p>
                            </div>
                        </div>
                        <div class="yes-no-buttons">
                            <button type="button" class="yes-no-btn" data-tool="audiodescricao"
                                data-value="sim">Sim</button>
                            <button type="button" class="yes-no-btn" data-tool="audiodescricao"
                                data-value="nao">Não</button>
                        </div>
                    </div>

                    <!-- LSE -->
                    <div class="tool-item">
                        <div class="tool-header">
                            <div class="tool-icon">
                                <i class="fas fa-sign-language"></i>
                            </div>
                            <div class="tool-info">
                                <h4>Língua de Sinais (LSE)</h4>
                                <p>Intérprete de Libras na tela</p>
                            </div>
                        </div>
                        <div class="yes-no-buttons">
                            <button type="button" class="yes-no-btn" data-tool="libras" data-value="sim">Sim</button>
                            <button type="button" class="yes-no-btn" data-tool="libras" data-value="nao">Não</button>
                        </div>
                    </div>

                    <!-- Controles de Acessibilidade -->
                    <div class="tool-item">
                        <div class="tool-header">
                            <div class="tool-icon">
                                <i class="fas fa-sliders-h"></i>
                            </div>
                            <div class="tool-info">
                                <h4>Controles de Vídeo</h4>
                                <p>Velocidade, contraste, tamanho da legenda</p>
                            </div>
                        </div>
                        <div class="yes-no-buttons">
                            <button type="button" class="yes-no-btn" data-tool="controles" data-value="sim">Sim</button>
                            <button type="button" class="yes-no-btn" data-tool="controles" data-value="nao">Não</button>
                        </div>
                    </div>
                </div>
            </div>


            <div class="form-section">
                <h3><i class="fas fa-star"></i> Avalie a qualidade das ferramentas utilizadas</h3>
                <div class="tool-rating-grid">
                    <!-- Avaliação Legenda -->
                    <div class="tool-item" id="legendaRating" style="display: none;">
                        <div class="tool-header">
                            <div class="tool-icon">
                                <i class="fas fa-closed-captioning"></i>
                            </div>
                            <div class="tool-info">
                                <h4>Qualidade da Legenda</h4>
                                <p>Sincronização, precisão, formatação</p>
                            </div>
                        </div>
                        <div class="star-rating">
                            <input type="radio" id="legenda5" name="legenda_quality" value="5">
                            <label for="legenda5">★</label>
                            <input type="radio" id="legenda4" name="legenda_quality" value="4">
                            <label for="legenda4">★</label>
                            <input type="radio" id="legenda3" name="legenda_quality" value="3">
                            <label for="legenda3">★</label>
                            <input type="radio" id="legenda2" name="legenda_quality" value="2">
                            <label for="legenda2">★</label>
                            <input type="radio" id="legenda1" name="legenda_quality" value="1">
                            <label for="legenda1">★</label>
                        </div>
                    </div>

                    <!-- Avaliação Audiodescrição -->
                    <div class="tool-item" id="audiodescricaoRating" style="display: none;">
                        <div class="tool-header">
                            <div class="tool-icon">
                                <i class="fas fa-assistive-listening-systems"></i>
                            </div>
                            <div class="tool-info">
                                <h4>Qualidade da Audiodescrição</h4>
                                <p>Clareza, detalhamento, sincronia</p>
                            </div>
                        </div>
                        <div class="star-rating">
                            <input type="radio" id="ad5" name="audiodescricao_quality" value="5">
                            <label for="ad5">★</label>
                            <input type="radio" id="ad4" name="audiodescricao_quality" value="4">
                            <label for="ad4">★</label>
                            <input type="radio" id="ad3" name="audiodescricao_quality" value="3">
                            <label for="ad3">★</label>
                            <input type="radio" id="ad2" name="audiodescricao_quality" value="2">
                            <label for="ad2">★</label>
                            <input type="radio" id="ad1" name="audiodescricao_quality" value="1">
                            <label for="ad1">★</label>
                        </div>
                    </div>
                </div>
            </div>


            <div class="form-section">
                <h3><i class="fas fa-lightbulb"></i> O que podemos melhorar?</h3>
                <div class="suggestions-grid">
                    <label class="suggestion-item">
                        <input type="checkbox" name="suggestions[]" value="mais_legendas">
                        <span>Mais opções de legendas</span>
                    </label>
                    <label class="suggestion-item">
                        <input type="checkbox" name="suggestions[]" value="mais_audiodescricao">
                        <span>Mais filmes com audiodescrição</span>
                    </label>
                    <label class="suggestion-item">
                        <input type="checkbox" name="suggestions[]" value="melhor_sincronia">
                        <span>Melhor sincronia de legendas</span>
                    </label>
                    <label class="suggestion-item">
                        <input type="checkbox" name="suggestions[]" value="mais_libras">
                        <span>Mais conteúdo com Libras</span>
                    </label>
                    <label class="suggestion-item">
                        <input type="checkbox" name="suggestions[]" value="controles_melhores">
                        <span>Controles mais intuitivos</span>
                    </label>
                    <label class="suggestion-item">
                        <input type="checkbox" name="suggestions[]" value="personalizacao">
                        <span>Mais opções de personalização</span>
                    </label>
                </div>

                <label for="outras_sugestoes" style="display: block; margin-top: 20px; color: white;">
                    Outras sugestões:
                </label>
                <textarea id="outras_sugestoes" name="outras_sugestoes" class="feedback-textarea"
                    placeholder="Compartilhe outras ideias para melhorarmos a acessibilidade..."></textarea>
            </div>

            <!-- Seção 4: Comentários Gerais -->
            <div class="form-section">
                <h3><i class="fas fa-comment-alt"></i> Comentários Adicionais</h3>
                <textarea id="comentarios_gerais" name="comentarios_gerais" class="feedback-textarea"
                    placeholder="Conte-nos mais sobre sua experiência com as ferramentas de acessibilidade..."></textarea>
            </div>

            <!-- Botões de Ação -->
            <div class="feedback-actions">
                <button type="button" class="btn-skip-feedback" id="skipBtn">
                    <i class="fas fa-forward"></i> Pular Feedback
                </button>
                <button type="submit" class="btn-submit-feedback">
                    <i class="fas fa-paper-plane"></i> Enviar Feedback
                </button>
            </div>
        </form>
    </main>

    <!-- Modal de Agradecimento -->
    <div class="thank-you-modal" id="thankYouModal">
        <div class="modal-content">
            <div class="modal-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h2>Obrigado pelo seu Feedback!</h2>
            <p>Sua opinião é muito importante para nós. Com sua ajuda, podemos tornar o MiraCine mais acessível para
                todos os usuários.</p>
            <p><strong>Você ganhou 50 pontos de experiência!</strong></p>
            <div class="modal-actions">
                <a href="catalog.html" class="btn-submit-feedback">
                    <i class="fas fa-film"></i> Explorar Catálogo
                </a>
                <a href="../index.html" class="btn-skip-feedback">
                    <i class="fas fa-home"></i> Voltar para Home
                </a>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div id="footer-container"></div>

    <script src="../js/template.js"></script>
    <script>

        // Sistema da Navbar de Feedback
        function initializeFeedbackNavbar() {
            const quickBtn = document.getElementById('accessibilityQuickBtn');
            const quickMenu = document.getElementById('feedbackQuickMenu');
            const userProfile = document.getElementById('feedbackUserProfile');
            const navProgressFill = document.getElementById('navProgressFill');

            // Menu rápido de ferramentas
            if (quickBtn && quickMenu) {
                quickBtn.addEventListener('click', function (e) {
                    e.stopPropagation();
                    quickMenu.classList.toggle('active');
                });

                // Fechar ao clicar fora
                document.addEventListener('click', function (e) {
                    if (!quickMenu.contains(e.target) && !quickBtn.contains(e.target)) {
                        quickMenu.classList.remove('active');
                    }
                });
            }

            // Perfil do usuário
            if (userProfile) {
                userProfile.addEventListener('click', function () {
                    window.location.href = 'profile.html';
                });
            }

            // Atualizar progresso na navbar
            function updateNavProgress() {
                const totalPoints = 250; // Pontuação atual do usuário
                const nextLevelPoints = 500; // Pontos para próximo nível
                const progressPercentage = (totalPoints / nextLevelPoints) * 100;

                if (navProgressFill) {
                    navProgressFill.style.width = `${Math.min(progressPercentage, 100)}%`;
                }
            }

            // Funções rápidas de feedback
            window.showQuickFeedback = function (type) {
                const messages = {
                    legendas: 'Feedback sobre legendas',
                    audiodescricao: 'Feedback sobre audiodescrição',
                    interface: 'Feedback sobre interface',
                    sugestoes: 'Enviar sugestão'
                };

                alert(`Abrindo formulário de: ${messages[type]}`);
                quickMenu.classList.remove('active');

                // Focar na seção específica
                if (type === 'legendas') {
                    document.querySelector('input[name="legenda_quality"]')?.focus();
                }
            };

            window.viewFeedbackHistory = function () {
                alert('Abrindo histórico completo de feedbacks...');
                // window.location.href = 'feedback-history.html';
                quickMenu.classList.remove('active');
            };

            // Inicializar
            updateNavProgress();

            // Atualizar contagem de feedbacks
            function updateFeedbackCount() {
                const feedbackCount = JSON.parse(localStorage.getItem('userFeedbacks') || '[]').length;
                const countBadge = document.querySelector('.feedback-count-badge');
                if (countBadge && feedbackCount > 0) {
                    countBadge.textContent = feedbackCount;
                }
            }

            updateFeedbackCount();
        }

        // Adicionar ao DOMContentLoaded
        document.addEventListener('DOMContentLoaded', function () {
            initializeFeedbackNavbar();
        });



        // Feedback de Acessibilidade
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.getElementById('accessibilityFeedbackForm');
            const skipBtn = document.getElementById('skipBtn');
            const thankYouModal = document.getElementById('thankYouModal');
            const progressFill = document.getElementById('progressFill');

            // Elementos que mostram/escondem avaliações
            const legendaRating = document.getElementById('legendaRating');
            const audiodescricaoRating = document.getElementById('audiodescricaoRating');

            // Ferramentas usadas
            let usedTools = {
                legenda: false,
                audiodescricao: false,
                libras: false,
                controles: false
            };

            // Atualizar progresso
            function updateProgress() {
                const sections = document.querySelectorAll('.form-section');
                const completedSections = Array.from(sections).filter(section => {
                    const inputs = section.querySelectorAll('input, textarea');
                    return Array.from(inputs).some(input => {
                        if (input.type === 'checkbox') return input.checked;
                        if (input.type === 'radio') return input.checked;
                        if (input.type === 'text' || input.tagName === 'TEXTAREA') return input.value.trim() !== '';
                        return false;
                    });
                }).length;

                const progress = (completedSections / sections.length) * 100;
                progressFill.style.width = `${progress}%`;

                // Atualizar texto do passo
                const progressText = document.querySelector('.progress-text span:first-child');
                progressText.textContent = `Passo ${completedSections + 1} de ${sections.length}`;
            }

            // Botões Sim/Não
            document.querySelectorAll('.yes-no-btn').forEach(button => {
                button.addEventListener('click', function () {
                    const tool = this.dataset.tool;
                    const value = this.dataset.value;

                    // Resetar botões do mesmo grupo
                    const parent = this.parentElement;
                    parent.querySelectorAll('.yes-no-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });

                    // Ativar botão clicado
                    this.classList.add('active');

                    // Atualizar ferramentas usadas
                    usedTools[tool] = (value === 'sim');

                    // Mostrar/ocultar avaliações
                    if (tool === 'legenda') {
                        legendaRating.style.display = usedTools[tool] ? 'block' : 'none';
                    }
                    if (tool === 'audiodescricao') {
                        audiodescricaoRating.style.display = usedTools[tool] ? 'block' : 'none';
                    }

                    updateProgress();
                });
            });

            // Estrelas de avaliação
            document.querySelectorAll('.star-rating input').forEach(star => {
                star.addEventListener('change', updateProgress);
            });

            // Checkboxes
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', updateProgress);
            });

            // Textareas
            document.querySelectorAll('textarea').forEach(textarea => {
                textarea.addEventListener('input', updateProgress);
            });

            // Pular feedback
            skipBtn.addEventListener('click', function (e) {
                e.preventDefault();
                if (confirm('Tem certeza que deseja pular o feedback? Sua opinião é muito importante para nós.')) {
                    window.location.href = 'catalog.html';
                }
            });

            // Enviar formulário
            form.addEventListener('submit', function (e) {
                e.preventDefault();

                // Coletar dados do formulário
                const formData = new FormData(form);
                const data = {
                    ferramentas_usadas: usedTools,
                    sugestoes: [],
                    comentarios: formData.get('comentarios_gerais'),
                    outras_sugestoes: formData.get('outras_sugestoes')
                };

                // Coletar sugestões selecionadas
                formData.getAll('suggestions[]').forEach(sugestao => {
                    data.sugestoes.push(sugestao);
                });

                // Coletar avaliações
                data.avaliacoes = {
                    legenda_quality: formData.get('legenda_quality'),
                    audiodescricao_quality: formData.get('audiodescricao_quality')
                };

                // Simular envio para o servidor
                console.log('Feedback enviado:', data);

                // Mostrar modal de agradecimento
                thankYouModal.classList.add('active');

                // Simular pontuação
                setTimeout(() => {
                    // Desabilitar formulário após envio
                    form.querySelectorAll('input, textarea, button').forEach(element => {
                        element.disabled = true;
                    });

                    // Redirecionar após 3 segundos
                    setTimeout(() => {
                        window.location.href = 'catalog.html';
                    }, 3000);
                }, 1000);
            });

            // Fechar modal ao clicar fora
            thankYouModal.addEventListener('click', function (e) {
                if (e.target === this) {
                    this.classList.remove('active');
                    window.location.href = 'catalog.html';
                }
            });

            // Inicializar progresso
            updateProgress();
        });
    </script>
</body>

</html>